<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Monastery360 ‚Äì Home</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v7.5.0/ol.css">
<style>
  body { 
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
    margin: 0; padding: 0; 
    background: #faf7f2; 
    text-align: center; 
    color: #333; 
  }

  header { 
    background: url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1350&q=80') center/cover no-repeat; 
    height: 100vh; 
    display: flex; 
    flex-direction: column; 
    justify-content: center; 
    align-items: center; 
    color: white; 
  }

  header h1 { 
    font-size: 3rem; 
    text-shadow: 2px 2px 4px rgba(0,0,0,0.7); 
  }

  header p { 
    font-size: 1.3rem; 
    max-width: 700px; 
    margin: 10px auto; 
    text-shadow: 1px 1px 3px rgba(0,0,0,0.6); 
  }

  .explore-btn { 
    background: #7c2d12; 
    color: white; 
    border: none; 
    padding: 14px 28px; 
    font-weight: bold; 
    border-radius: 30px; 
    font-size: 1.2rem; 
    cursor: pointer; 
    text-decoration: none; 
    transition: background 0.3s; 
    display: inline-block; 
    margin-top: 10px;
  }

  .explore-btn:hover { background: #b45309; }

  #map { 
    width: 90%; 
    height: 600px; 
    margin: 40px auto; 
    border: 2px solid #ccc; 
    border-radius: 12px; 
    background: white; 
  }

  .ol-popup {
    position: absolute;
    background-color: white;
    padding: 6px 12px;
    border: 1px solid #7c2d12;
    border-radius: 6px;
    bottom: 12px;
    left: -50px;
    min-width: 140px;
    font-weight: bold;
    color: #7c2d12;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }

  /* Sidebar */
  .sidebar { 
    height: 100%; 
    width: 0; 
    position: fixed; 
    z-index: 1000; 
    top: 0; 
    left: 0; 
    background-color: #7c2d12; 
    overflow-x: hidden; 
    transition: 0.3s; 
    padding-top: 60px; 
  }

  .sidebar a { 
    padding: 12px 24px; 
    text-decoration: none; 
    font-size: 1.2rem; 
    color: white; 
    display: block; 
    transition: 0.3s; 
  }

  .sidebar a:hover { background-color: #b45309; }
  .sidebar .closebtn { position: absolute; top: 15px; right: 20px; font-size: 2rem; }
  .hamburger { position: fixed; top: 15px; left: 20px; font-size: 2rem; cursor: pointer; color: white; z-index: 1100; }
</style>
</head>
<body>

<!-- Sidebar -->
<div id="mySidebar" class="sidebar">
  <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">√ó</a>
  <a href="index.html">Home</a>
  <a href="audio-guide.html">Audio Guide</a>
  <a href="tourism.html">Tourism Service</a>
</div>


<!-- Hamburger Icon -->
<div class="hamburger" onclick="openNav()">‚ò∞</div>

<header>
  <h1>Monastery360</h1>
  <p>Experience the spiritual, cultural, and historical treasures of Sikkim‚Äôs monasteries through digital archives, interactive tours, and immersive maps.</p>
  <a href="monasteries.html" class="explore-btn">Explore Monasteries</a>
</header>

<div id="map"></div>

<script src="https://cdn.jsdelivr.net/npm/ol@v7.5.0/dist/ol.js"></script>
<script>
 
  var map = new ol.Map({
    target: 'map',
    layers: [ new ol.layer.Tile({ source: new ol.source.OSM() }) ],
    view: new ol.View({ center: ol.proj.fromLonLat([88.61, 27.33]), zoom: 9 })
  });


  var monasteries = [
    
    {name: "Rumtek Dharma Chakra Centre", coords: [88.5614622, 27.2886861]},
    {name: "Mamring Monastery", coords: [88.3101201, 27.277364]},
    {name: "Enchey Monastery", coords: [88.6191659, 27.3359368]},
    {name: "Burtuk", coords: [88.6158468, 27.3539598]},
    {name: "Do Drul Chorten", coords: [88.6048366, 27.3128415]},
    {name: "Decchen Cholling Gumpa-Tamamg Gumpa", coords: [88.608536, 27.338795]},
    {name: "Bermiok Tokal Monastery", coords: [88.4690827, 27.2287152]},
    {name: "Tashiding Monastery", coords: [88.2978746, 27.3089308]},
    {name: "Sinon Monastery", coords: [88.2900301, 27.3423753]},
    {name: "Kartok Monastery", coords: [88.588005, 27.2407996]},
    {name: "Sanghak Choeling Monastery", coords: [88.2216867, 27.2977517]},
    {name: "Pema Choling Monastery", coords: [88.5310593, 27.1757119]},
    {name: "Pal Karma Zurmang Shedup Chokhor Ling Lingdum Monastery (Ranka Monastery)", coords: [88.5790387, 27.3311957]},
    {name: "Lingdum Zurmang Kagyu Monastery", coords: [88.5805594, 27.3307583]},
    {name: "Rinchenpong Monastery", coords: [88.2684733, 27.2354672]},
    {name: "Rinchen Choling Tamu Monastery/ Gurung Gompha", coords: [88.2708814, 27.2432459]},
    {name: "Pemayangtse Monastery", coords: [88.2515852, 27.3052201]},
    {name: "Okhrey Monastery", coords: [88.1019019, 27.149513]},
    {name: "Khecheopalri Monastery", coords: [88.1882768, 27.349221]},
    {name: "Hung hri Monastery", coords: [88.2535011, 27.3523006]},
    {name: "Dubdi Buddhist Monastery - Yuksom", coords: [88.2299922, 27.3665529]},
    {name: "Dodak Buddhist Monastery", coords: [88.1715435, 27.1718352]},
    {name: "Tendong Gumpa", coords: [88.4079885, 27.2061039]},
    {name: "Chang Chu Monastery", coords: [88.4032499, 27.2959417]},
    {name: "Serdup Choling Monastery", coords: [88.3547474, 27.161498]},
    {name: "Sharchhog Bayphug", coords: [88.385782, 27.2763652]},
    {name: "Ralang New Monastery", coords: [88.3352477, 27.3284964]},
    {name: "Mane Choekhorling Gompa (Ravangla Monastery)", coords: [88.518887, 28.240229]},
    {name: "Ngadak Thupten Shedup Dhargey Choeling, Monastery", coords: [88.3706278, 27.1732407]},
    {name: "Norbu Yangdup Choling Monastery", coords: [88.3773796, 27.2345473]},
    {name: "Phagyal monastery Lingee", coords: [88.4592622, 27.37048]},
    {name: "Kewzing Monastery", coords: [88.3227697, 27.2842636]},
    {name: "Doling Monastery", coords: [88.3449117, 27.287967]},
    {name: "Norbu gang, Coronation throne of Namgyal Dynasty", coords: [88.2173761, 27.3694863]},
    {name: "Bon Monastery", coords: [88.3343804, 27.278643]},
    {name: "Chawayng Ani Monastery", coords: [88.5122178, 27.5329718]},
    {name: "Tholung Monastery", coords: [88.4615734, 27.636972]},
    {name: "Tingvong Monastery", coords: [88.4767615, 27.5568019]},
    {name: "Tashi Gyan Palden Monastery", coords: [88.4127344, 27.2866497]},
    {name: "Ringhem Monastery", coords: [88.5462414, 27.4953153]},
    {name: "Phodong Monastery", coords: [88.5838205, 27.4128715]},
    {name: "Phensang Monastery", coords: [88.6101296, 27.420723]},
    {name: "Lingthem Rikzing Chopel Targelling Monastery", coords: [88.5011052, 27.5230064]},
    {name: "Lachung Monastery", coords: [88.7487553, 27.6886827]},
    {name: "Lachen Monastery", coords: [88.5577391, 27.7166667]},
    {name: "Labrang Monastery", coords: [88.5794589, 27.4180001]},
    {name: "KABI MONASTERY", coords: [88.6099182, 27.4007368]},
    {name: "HEE GYATHANG MONASTERY", coords: [88.501073, 27.4758646]},
    {name: "Simik Monastery", coords: [88.4718882, 27.2873094]},
    {name: "Rhenock Gumpa, Monastery", coords: [88.6779745, 27.1842602]},
    {name: "Tsuglakhang Monastery & Temple", coords: [88.6147222, 27.3261111]},
    {name: "Gonjang Monastery", coords: [88.6132007, 27.3690385]},
    {name: "Singtam Monastery", coords: [88.5035101, 27.2341097]},
    {name: "Mintokgang Road", coords: [88.6176397, 27.3332951]},
    {name: "Pabyuik Monastery", coords: [88.6279545, 27.2993719]},
    {name: "Old Rumtek Monastery", coords: [88.563264, 27.2846735]}
  ];

  var features = monasteries.map(function(m) {
    return new ol.Feature({ geometry: new ol.geom.Point(ol.proj.fromLonLat(m.coords)), name: m.name });
  });

  var vectorSource = new ol.source.Vector({ features: features });

  var vectorLayer = new ol.layer.Vector({
    source: vectorSource,
    style: new ol.style.Style({
      image: new ol.style.Icon({ src: 'https://cdn-icons-png.flaticon.com/512/684/684908.png', scale: 0.05 })
    })
  });

  map.addLayer(vectorLayer);


  var overlay = new ol.Overlay({ element: document.createElement('div'), positioning: 'bottom-center', stopEvent: false });
  overlay.getElement().className = 'ol-popup';
  map.addOverlay(overlay);

  map.on('singleclick', function(evt) {
    var feature = map.forEachFeatureAtPixel(evt.pixel, function(f) { return f; });
    if (feature) {
      var coordinates = feature.getGeometry().getCoordinates();
      overlay.getElement().innerHTML = feature.get('name');
      overlay.setPosition(coordinates);
      overlay.getElement().style.display = 'block';
    } else {
      overlay.getElement().style.display = 'none';
    }
  });


  function openNav() { document.getElementById("mySidebar").style.width = "250px"; }
  function closeNav() { document.getElementById("mySidebar").style.width = "0"; }
</script>

<!-- Integrated Monastery Chatbot Widget -->
<div id="monasteryBot" class="monastery-chatbot">
  <!-- Chatbot Toggle Button -->
  <div class="chatbot-toggle" id="chatbotToggle">
    <i class="fas fa-temple-buddhist"></i>
    <div class="toggle-tooltip">Ask about monasteries</div>
  </div>

  <!-- Chatbot Window -->
  <div class="chatbot-window" id="chatbotWindow">
    <!-- Header -->
    <div class="chatbot-header">
      <div class="header-content">
        <div class="bot-avatar">
          <i class="fas fa-temple-buddhist"></i>
        </div>
        <div class="header-text">
          <h4>Monastery Guide</h4>
          <p>Ask me about Sikkim's sacred monasteries</p>
        </div>
        <button class="close-btn" id="closeChatbot">
          <i class="fas fa-times"></i>
        </button>
      </div>
    </div>

    <!-- Messages Area -->
    <div class="chatbot-messages" id="chatbotMessages">
      <div class="message bot-message welcome-message">
        <div class="message-avatar">
          <i class="fas fa-temple-buddhist"></i>
        </div>
        <div class="message-content">
          <p>üôè Namaste! I'm your monastery guide. Ask me about any monastery in Sikkim - their history, location, festivals, or visiting tips!</p>
          <div class="quick-suggestions">
            <button class="suggestion-btn" onclick="sendSuggestion('Tell me about Rumtek Monastery')">Rumtek Monastery</button>
            <button class="suggestion-btn" onclick="sendSuggestion('What are the major festivals?')">Festival Info</button>
            <button class="suggestion-btn" onclick="sendSuggestion('Best time to visit monasteries')">Best Time</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Typing Indicator -->
    <div class="typing-indicator" id="typingIndicator" style="display: none;">
      <div class="message bot-message">
        <div class="message-avatar">
          <i class="fas fa-temple-buddhist"></i>
        </div>
        <div class="message-content">
          <div class="typing-dots">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>
      </div>
    </div>

    <!-- Input Area -->
    <div class="chatbot-input">
      <div class="input-container">
        <input type="text" id="chatbotInput" placeholder="Ask about monasteries..." maxlength="500">
        <button id="sendMessage" class="send-btn">
          <i class="fas fa-paper-plane"></i>
        </button>
      </div>
      <div class="input-footer">
        <small>Powered by AI ‚Ä¢ Monastery360</small>
      </div>
    </div>
  </div>
</div>

<style>
/* Monastery Chatbot Styles */
.monastery-chatbot {
  position: fixed;
  bottom: 2rem;
  right: 2rem;
  z-index: 10000;
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
}

/* Toggle Button */
.chatbot-toggle {
  width: 60px;
  height: 60px;
  background: linear-gradient(135deg, #7c2d12, #b45309);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 8px 25px rgba(124, 45, 18, 0.3);
  transition: all 0.3s ease;
  position: relative;
  animation: pulse 2s infinite;
}

.chatbot-toggle:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 35px rgba(124, 45, 18, 0.4);
}

.chatbot-toggle i {
  color: white;
  font-size: 1.5rem;
}

.toggle-tooltip {
  position: absolute;
  right: 70px;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(0, 0, 0, 0.8);
  color: white;
  padding: 0.5rem 1rem;
  border-radius: 8px;
  font-size: 0.875rem;
  white-space: nowrap;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
}

.chatbot-toggle:hover .toggle-tooltip {
  opacity: 1;
  visibility: visible;
}

@keyframes pulse {
  0% { box-shadow: 0 8px 25px rgba(124, 45, 18, 0.3); }
  50% { box-shadow: 0 8px 25px rgba(124, 45, 18, 0.5), 0 0 0 10px rgba(124, 45, 18, 0.1); }
  100% { box-shadow: 0 8px 25px rgba(124, 45, 18, 0.3); }
}

/* Chatbot Window */
.chatbot-window {
  position: absolute;
  bottom: 80px;
  right: 0;
  width: 380px;
  height: 600px;
  background: white;
  border-radius: 20px;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
  transform: translateY(20px) scale(0.95);
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.chatbot-window.active {
  transform: translateY(0) scale(1);
  opacity: 1;
  visibility: visible;
}

/* Header */
.chatbot-header {
  background: linear-gradient(135deg, #7c2d12, #b45309);
  padding: 1.5rem;
  color: white;
}

.header-content {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.bot-avatar {
  width: 40px;
  height: 40px;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
}

.header-text h4 {
  margin: 0;
  font-size: 1.1rem;
  font-weight: 600;
}

.header-text p {
  margin: 0;
  font-size: 0.875rem;
  opacity: 0.9;
}

.close-btn {
  margin-left: auto;
  background: none;
  border: none;
  color: white;
  font-size: 1.2rem;
  cursor: pointer;
  padding: 0.5rem;
  border-radius: 50%;
  transition: background 0.3s ease;
}

.close-btn:hover {
  background: rgba(255, 255, 255, 0.1);
}

/* Messages */
.chatbot-messages {
  flex: 1;
  overflow-y: auto;
  padding: 1rem;
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.message {
  display: flex;
  gap: 0.75rem;
  align-items: flex-start;
}

.message-avatar {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.875rem;
  flex-shrink: 0;
}

.bot-message .message-avatar {
  background: linear-gradient(135deg, #7c2d12, #b45309);
  color: white;
}

.user-message {
  flex-direction: row-reverse;
}

.user-message .message-avatar {
  background: #f3f4f6;
  color: #6b7280;
}

.message-content {
  background: #f8fafc;
  padding: 0.75rem 1rem;
  border-radius: 18px;
  max-width: 75%;
  word-wrap: break-word;
}

.user-message .message-content {
  background: linear-gradient(135deg, #7c2d12, #b45309);
  color: white;
}

.message-content p {
  margin: 0;
  line-height: 1.5;
}

/* Quick Suggestions */
.quick-suggestions {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-top: 0.75rem;
}

.suggestion-btn {
  background: rgba(124, 45, 18, 0.1);
  border: 1px solid rgba(124, 45, 18, 0.2);
  color: #7c2d12;
  padding: 0.5rem 0.75rem;
  border-radius: 16px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.3s ease;
}

.suggestion-btn:hover {
  background: rgba(124, 45, 18, 0.2);
  transform: translateY(-1px);
}

/* Typing Indicator */
.typing-dots {
  display: flex;
  gap: 4px;
  align-items: center;
}

.typing-dots span {
  width: 8px;
  height: 8px;
  background: #7c2d12;
  border-radius: 50%;
  animation: typing 1.4s infinite;
}

.typing-dots span:nth-child(2) {
  animation-delay: 0.2s;
}

.typing-dots span:nth-child(3) {
  animation-delay: 0.4s;
}

@keyframes typing {
  0%, 60%, 100% { opacity: 0.3; }
  30% { opacity: 1; }
}

/* Input Area */
.chatbot-input {
  border-top: 1px solid #e5e7eb;
  background: white;
}

.input-container {
  display: flex;
  padding: 1rem;
  gap: 0.75rem;
  align-items: center;
}

.chatbot-input input {
  flex: 1;
  border: 2px solid #e5e7eb;
  border-radius: 25px;
  padding: 0.75rem 1rem;
  font-size: 0.875rem;
  outline: none;
  transition: border-color 0.3s ease;
}

.chatbot-input input:focus {
  border-color: #7c2d12;
  box-shadow: 0 0 0 3px rgba(124, 45, 18, 0.1);
}

.send-btn {
  width: 40px;
  height: 40px;
  background: linear-gradient(135deg, #7c2d12, #b45309);
  border: none;
  border-radius: 50%;
  color: white;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
}

.send-btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(124, 45, 18, 0.3);
}

.send-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.input-footer {
  padding: 0.5rem 1rem;
  text-align: center;
  border-top: 1px solid #f3f4f6;
}

.input-footer small {
  color: #9ca3af;
  font-size: 0.75rem;
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .monastery-chatbot {
    bottom: 1rem;
    right: 1rem;
  }
  
  .chatbot-window {
    width: calc(100vw - 2rem);
    height: 70vh;
    max-width: 350px;
  }
  
  .toggle-tooltip {
    display: none;
  }
}

/* Scrollbar Styling */
.chatbot-messages::-webkit-scrollbar {
  width: 4px;
}

.chatbot-messages::-webkit-scrollbar-track {
  background: #f1f1f1;
}

.chatbot-messages::-webkit-scrollbar-thumb {
  background: #ccc;
  border-radius: 2px;
}

.chatbot-messages::-webkit-scrollbar-thumb:hover {
  background: #999;
}
</style>

<script>
class MonasteryChatbot {
  constructor() {
    this.isOpen = false;
    this.messages = [];
    this.apiEndpoint = 'http://127.0.0.1:5000/predict'; // Flask chatbot endpoint
    
    this.initializeElements();
    this.attachEventListeners();
    this.initializeChat();
  }

  initializeElements() {
    this.toggle = document.getElementById('chatbotToggle');
    this.window = document.getElementById('chatbotWindow');
    this.closeBtn = document.getElementById('closeChatbot');
    this.messagesContainer = document.getElementById('chatbotMessages');
    this.input = document.getElementById('chatbotInput');
    this.sendBtn = document.getElementById('sendMessage');
    this.typingIndicator = document.getElementById('typingIndicator');
  }

  attachEventListeners() {
    this.toggle.addEventListener('click', () => this.toggleChat());
    this.closeBtn.addEventListener('click', () => this.closeChat());
    this.sendBtn.addEventListener('click', () => this.handleSend());
    
    this.input.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        this.handleSend();
      }
    });

    // Close on outside click
    document.addEventListener('click', (e) => {
      if (this.isOpen && !this.window.contains(e.target) && !this.toggle.contains(e.target)) {
        this.closeChat();
      }
    });
  }

  toggleChat() {
    if (this.isOpen) {
      this.closeChat();
    } else {
      this.openChat();
    }
  }

  openChat() {
    this.isOpen = true;
    this.window.classList.add('active');
    this.input.focus();
    
    // Track analytics
    if (typeof gtag !== 'undefined') {
      gtag('event', 'chatbot_opened', {
        event_category: 'engagement',
        event_label: 'monastery_chatbot'
      });
    }
  }

  closeChat() {
    this.isOpen = false;
    this.window.classList.remove('active');
  }

  async handleSend() {
    const message = this.input.value.trim();
    if (!message) return;

    // Add user message
    this.addMessage(message, 'user');
    this.input.value = '';
    this.sendBtn.disabled = true;

    // Show typing indicator
    this.showTyping();

    try {
      // Send to Flask chatbot API
      const response = await this.sendToAPI(message);
      this.hideTyping();
      this.addMessage(response, 'bot');
    } catch (error) {
      this.hideTyping();
      this.addMessage('Sorry, I\'m having trouble connecting. Please try again later or visit our monastery pages directly.', 'bot');
      console.error('Chatbot API Error:', error);
    }

    this.sendBtn.disabled = false;
  }

  async sendToAPI(message) {
    try {
      const response = await fetch(this.apiEndpoint, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ message: message })
      });

      if (!response.ok) {
        throw new Error('API request failed');
      }

      const data = await response.json();
      return data.answer;
    } catch (error) {
      // Fallback responses if API is not available
      return this.getFallbackResponse(message);
    }
  }

  getFallbackResponse(message) {
    const lowerMessage = message.toLowerCase();
    
    if (lowerMessage.includes('rumtek')) {
      return 'üèõÔ∏è Rumtek Monastery is one of the most important monasteries in Sikkim! It serves as the seat of the Karmapa and houses precious Buddhist artifacts. Visit our Rumtek page for virtual tours and detailed information.';
    } else if (lowerMessage.includes('enchey')) {
      return 'üôè Enchey Monastery is a beautiful 200-year-old monastery above Gangtok, famous for its annual Cham dance festival. Check out our Enchey page for more details!';
    } else if (lowerMessage.includes('festival') || lowerMessage.includes('cham')) {
      return 'üé≠ Sikkim monasteries host amazing festivals like Losar (New Year), Saga Dawa, and spectacular Cham masked dances. Each monastery page has a cultural calendar with festival dates!';
    } else if (lowerMessage.includes('visit') || lowerMessage.includes('time')) {
      return 'üå∏ The best time to visit monasteries is March-May (spring flowers) and October-December (clear mountain views & festivals). Each monastery page has specific visiting information!';
    } else {
      return 'üôè I can help you learn about Sikkim\'s monasteries! Try asking about specific monasteries like Rumtek, Enchey, or Pemayangtse, or ask about festivals, visiting times, and locations.';
    }
  }

  addMessage(content, type) {
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${type}-message`;
    
    const avatar = document.createElement('div');
    avatar.className = 'message-avatar';
    avatar.innerHTML = type === 'bot' ? '<i class="fas fa-temple-buddhist"></i>' : '<i class="fas fa-user"></i>';
    
    const messageContent = document.createElement('div');
    messageContent.className = 'message-content';
    messageContent.innerHTML = `<p>${content}</p>`;
    
    messageDiv.appendChild(avatar);
    messageDiv.appendChild(messageContent);
    
    // Insert before typing indicator or at the end
    if (this.typingIndicator.style.display === 'none') {
      this.messagesContainer.appendChild(messageDiv);
    } else {
      this.messagesContainer.insertBefore(messageDiv, this.typingIndicator);
    }
    
    this.scrollToBottom();
  }

  showTyping() {
    this.typingIndicator.style.display = 'block';
    this.scrollToBottom();
  }

  hideTyping() {
    this.typingIndicator.style.display = 'none';
  }

  scrollToBottom() {
    setTimeout(() => {
      this.messagesContainer.scrollTop = this.messagesContainer.scrollHeight;
    }, 100);
  }

  initializeChat() {
    // Chat is initialized with welcome message in HTML
    this.scrollToBottom();
  }
}

// Quick suggestion function
function sendSuggestion(text) {
  const chatbot = window.monasteryChatbot;
  if (chatbot) {
    chatbot.input.value = text;
    chatbot.handleSend();
  }
}

// Initialize chatbot when DOM is loaded
document.addEventListener('DOMContentLoaded', function() {
  window.monasteryChatbot = new MonasteryChatbot();
});
</script>
</body>
</html>
